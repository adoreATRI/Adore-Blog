---

import fs from "node:fs";
import path from "node:path";
import { footerConfig, profileConfig } from "../config";
import { navigateToPage } from "../utils/navigation-utils";
import { url } from "../utils/url-utils";

const currentYear = new Date().getFullYear();

// 博客启动日期（请根据实际情况修改）
const blogStartDate = new Date('2025-10-25'); // 修改为您的博客启动日期

// 读取FooterConfig.html文件内容
let customFooterHtml = "";
if (footerConfig.enable) {
	try {
		const footerConfigPath = path.join(
			process.cwd(),
			"src",
			"FooterConfig.html",
		);
		customFooterHtml = fs.readFileSync(footerConfigPath, "utf-8");
		// 移除HTML注释
		customFooterHtml = customFooterHtml.replace(/<!--[\s\S]*?-->/g, "").trim();
	} catch (error) {
		console.warn("FooterConfig.html文件读取失败:", error.message);
	}
}
---

<!--<div class="border-t border-[var(&#45;&#45;primary)] mx-16 border-dashed py-8 max-w-[var(&#45;&#45;page-width)] flex flex-col items-center justify-center px-6">-->
<div class="transition border-t border-black/10 dark:border-white/15 my-10 border-dashed mx-32"></div>
<!--<div class="transition bg-[oklch(92%_0.01_var(&#45;&#45;hue))] dark:bg-black rounded-2xl py-8 mt-4 mb-8 flex flex-col items-center justify-center px-6">-->
<div class="transition border-dashed border-[oklch(85%_0.01_var(--hue))] dark:border-white/15 rounded-2xl mb-12 flex flex-col items-center justify-center px-6">
    <div class="transition text-50 text-sm text-center">
        {customFooterHtml && (
            <div class="mb-2" set:html={customFooterHtml}></div>
        )}
        &copy; <span id="copyright-year">{currentYear}</span> {profileConfig.name}. All Rights Reserved. /
        <a class="transition link text-[var(--primary)] font-medium" href={url('rss/')} onclick={`event.preventDefault(); navigateToPage('${url('rss/')}')`}>RSS</a> /
		<a class="transition link text-[var(--primary)] font-medium" href={url('atom/')} onclick={`event.preventDefault(); navigateToPage('${url('atom/')}')`}>Atom</a> /
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href={url('sitemap-index.xml')}>Sitemap</a><br>
        Powered by
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://astro.build">Astro</a> &
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/matsuzaka-yuki/mizuki">Mizuki</a>&nbsp; Version <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/matsuzaka-yuki/mizuki">6.0</a><br>
        <span id="blog-running-time">博客已运行 <span id="running-days" class="transition text-[var(--primary)] font-medium">0</span> 天</span>
        

    </div>
</div>

<script is:inline define:vars={{ blogStartDate: blogStartDate.toISOString() }}>
    // 计算博客运行天数
    function updateRunningDays() {
        const startDate = new Date(blogStartDate);
        const currentDate = new Date();
        const timeDiff = currentDate - startDate;
        const daysDiff = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
        
        const runningDaysElement = document.getElementById('running-days');
        if (runningDaysElement) {
            runningDaysElement.textContent = daysDiff;
        }
    }
    
    // 页面加载时更新
    updateRunningDays();
    
    // 如果使用了 Swup，在页面切换后也要更新
    if (typeof window !== 'undefined') {
        document.addEventListener('DOMContentLoaded', updateRunningDays);
        document.addEventListener('swup:page:view', updateRunningDays);
    }
</script>
